<!DOCTYPE html>
<html lang="th">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>‡πÅ‡∏î‡∏ä‡∏ö‡∏≠‡∏£‡πå‡∏î‡∏ß‡∏¥‡πÄ‡∏Ñ‡∏£‡∏≤‡∏∞‡∏´‡πå‡∏ú‡∏•‡∏™‡∏≠‡∏ö‡πÇ‡∏Ñ‡∏£‡∏á‡∏á‡∏≤‡∏ô</title>

  <!-- ‚úÖ Tailwind -->
  <script src="https://cdn.tailwindcss.com"></script>

  <!-- ‚úÖ Chart.js -->
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

  <!-- ‚úÖ SheetJS -->
  <script src="https://cdn.jsdelivr.net/npm/xlsx@0.18.5/dist/xlsx.full.min.js"></script>

<link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Kanit:wght@400;500;600;700&display=swap" rel="stylesheet">
  <style>
    body {
      font-family: 'Kanit', sans-serif;
      background-color: #f4f7fa;
    }
  </style>
</head>
<body>

  <!-- Header -->
  <header class="bg-gradient-to-r from-indigo-700 to-blue-600 text-white p-6 text-center shadow-lg">
    
    <h1 class="text-3xl font-bold">‡πÅ‡∏î‡∏ä‡∏ö‡∏≠‡∏£‡πå‡∏î‡∏ß‡∏¥‡πÄ‡∏Ñ‡∏£‡∏≤‡∏∞‡∏´‡πå‡∏ú‡∏•‡∏Å‡∏≤‡∏£‡∏™‡∏≠‡∏ö‡πÇ‡∏Ñ‡∏£‡∏á‡∏á‡∏≤‡∏ô‡∏ô‡∏±‡∏Å‡∏®‡∏∂‡∏Å‡∏©‡∏≤</h1>
    <button id="sidebar-toggle-btn" class="text-white text-2xl lg:hidden">
                    <svg class="h-6 w-6" fill="none" stroke="currentColor" viewBox="0 0 24 24"
                        xmlns="http://www.w3.org/2000/svg">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                            d="M4 6h16M4 12h16M4 18h16">
                        </path>
                    </svg>
                </button>
    <p class="mt-2 text-blue-200">‡∏™‡∏£‡∏∏‡∏õ‡∏ú‡∏•‡πÄ‡∏ä‡∏¥‡∏á‡∏™‡∏ñ‡∏¥‡∏ï‡∏¥ ‡∏≠‡∏±‡∏ï‡∏£‡∏≤‡∏Å‡∏≤‡∏£‡∏ú‡πà‡∏≤‡∏ô ‡πÅ‡∏•‡∏∞‡∏Å‡∏≤‡∏£‡πÄ‡∏õ‡∏£‡∏µ‡∏¢‡∏ö‡πÄ‡∏ó‡∏µ‡∏¢‡∏ö‡∏£‡∏≤‡∏¢‡∏™‡∏≤‡∏Ç‡∏≤</p>
  </header>

<div class="flex flex-grow lg:flex-row flex-col">
        <aside id="sidebar"
            class="sidebar lg:relative fixed top-0 left-0 h-full overflow-y-auto z-30 lg:block lg:p-4 bg-white shadow-md flex-grow min-h-screen w-[450px] ">
            <div
                class="p-4 bg-indigo-700 text-white flex items-center justify-between lg:justify-start lg:rounded-t-lg lg:hidden">
                <h3 class="text-xl font-bold">‡πÄ‡∏°‡∏ô‡∏π</h3>
                <button id="sidebar-close-btn" class="lg:hidden text-white text-2xl">&times;</button>
            </div>
            <nav class="p-1 bg-white lg:rounded-b-lg">
                <ul class="space-y-2">
                       <li>
                        <a href="/admin/Dashbroad_admin.html"
                            class="flex items-center p-3 text-gray-700 hover:bg-gray-100 rounded-md transition-colors">
                            <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 mr-3 text-indigo-500"
                                viewBox="0 0 20 20" fill="currentColor">
                                <path
                                    d="M9 2a1 1 0 00-1 1v2a1 1 0 002 0V3a1 1 0 00-1-1zM5.553 4.847a1 1 0 00-1.414 1.414l1.414 1.414a1 1 0 101.414-1.414L5.553 4.847zM3 9a1 1 0 000 2h2a1 1 0 100-2H3zM4.847 14.447a1 1 0 00-1.414-1.414l-1.414 1.414a1 1 0 101.414 1.414l1.414-1.414zM9 17a1 1 0 00-1 1v2a1 1 0 102 0v-2a1 1 0 00-1-1zM14.447 19.153a1 1 0 001.414-1.414l-1.414-1.414a1 1 0 00-1.414 1.414l1.414 1.414zM17 10a1 1 0 000-2h2a1 1 0 100 2h-2zM19.153 14.447a1 1 0 00-1.414 1.414l1.414 1.414a1 1 0 001.414-1.414l-1.414-1.414z" />
                            </svg>
                            ‡∏Å‡∏•‡∏±‡∏ö‡∏´‡∏ô‡πâ‡∏≤‡∏´‡∏•‡∏±‡∏Å
                        </a>
                    </li>

                    <li>
                        <a href="manage_toppic.html"
                            class="flex items-center p-3 text-gray-700 hover:bg-gray-100 rounded-md transition-colors">
                            <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 mr-3 text-indigo-500"
                                viewBox="0 0 20 20" fill="currentColor">
                                <path
                                    d="M10 2a8 8 0 100 16 8 8 0 000-16zM8 7.5a.5.5 0 01.5-.5h3a.5.5 0 010 1h-3a.5.5 0 01-.5-.5zM7.5 10a.5.5 0 01.5-.5h4a.5.5 0 010 1h-4a.5.5 0 01-.5-.5zM7.5 12.5a.5.5 0 01.5-.5h4a.5.5 0 010 1h-4a.5.5 0 01-.5-.5z" />
                            </svg>
                            ‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏Å‡∏≤‡∏£‡∏Ç‡∏∂‡πâ‡∏ô‡∏™‡∏≠‡∏ö‡∏´‡∏±‡∏ß‡∏Ç‡πâ‡∏≠‡πÇ‡∏Ñ‡∏£‡∏á‡∏á‡∏≤‡∏ô
                        </a>
                    </li>
                    <li>
                        <a href="Check_status_project.html"
                            class="flex items-center p-3 text-gray-700 hover:bg-gray-100 rounded-md transition-colors">
                            <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 mr-3 text-indigo-500"
                                viewBox="0 0 20 20" fill="currentColor">
                                <path
                                    d="M10 2a8 8 0 100 16 8 8 0 000-16zM8 7.5a.5.5 0 01.5-.5h3a.5.5 0 010 1h-3a.5.5 0 01-.5-.5zM7.5 10a.5.5 0 01.5-.5h4a.5.5 0 010 1h-4a.5.5 0 01-.5-.5zM7.5 12.5a.5.5 0 01.5-.5h4a.5.5 0 010 1h-4a.5.5 0 01-.5-.5z" />
                            </svg>
                            ‡∏ï‡∏¥‡∏î‡∏ï‡∏≤‡∏°‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡πÇ‡∏Ñ‡∏£‡∏á‡∏á‡∏≤‡∏ô
                        </a>
                    </li>
                    <li>
                        <a href="/admin/manage_final_round.html"
                            class="flex items-center p-3 text-gray-700 hover:bg-gray-100 rounded-md transition-colors">
                            <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 mr-3 text-indigo-500"
                                viewBox="0 0 20 20" fill="currentColor">
                                <path
                                    d="M9 2a1 1 0 00-1 1v2a1 1 0 002 0V3a1 1 0 00-1-1zM5.553 4.847a1 1 0 00-1.414 1.414l1.414 1.414a1 1 0 101.414-1.414L5.553 4.847zM3 9a1 1 0 000 2h2a1 1 0 100-2H3zM4.847 14.447a1 1 0 00-1.414-1.414l-1.414 1.414a1 1 0 101.414 1.414l1.414-1.414zM9 17a1 1 0 00-1 1v2a1 1 0 102 0v-2a1 1 0 00-1-1zM14.447 19.153a1 1 0 001.414-1.414l-1.414-1.414a1 1 0 00-1.414 1.414l1.414 1.414zM17 10a1 1 0 000-2h2a1 1 0 100 2h-2zM19.153 14.447a1 1 0 00-1.414 1.414l1.414 1.414a1 1 0 001.414-1.414l-1.414-1.414z" />
                            </svg>
                            ‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏Å‡∏≤‡∏£‡∏Ç‡∏∂‡πâ‡∏ô‡∏™‡∏≠‡∏ö‡∏à‡∏ö‡πÇ‡∏Ñ‡∏£‡∏á‡∏á‡∏≤‡∏ô
                        </a>
                    </li>

                   <li>
                        <a href="/admin/approve_defense.html"
                            class="flex items-center p-3 text-gray-700 hover:bg-gray-100 rounded-md transition-colors">
                            <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 mr-3 text-indigo-500"
                                viewBox="0 0 20 20" fill="currentColor">
                                <path
                                    d="M9 2a1 1 0 00-1 1v2a1 1 0 002 0V3a1 1 0 00-1-1zM5.553 4.847a1 1 0 00-1.414 1.414l1.414 1.414a1 1 0 101.414-1.414L5.553 4.847zM3 9a1 1 0 000 2h2a1 1 0 100-2H3zM4.847 14.447a1 1 0 00-1.414-1.414l-1.414 1.414a1 1 0 101.414 1.414l1.414-1.414zM9 17a1 1 0 00-1 1v2a1 1 0 102 0v-2a1 1 0 00-1-1zM14.447 19.153a1 1 0 001.414-1.414l-1.414-1.414a1 1 0 00-1.414 1.414l1.414 1.414zM17 10a1 1 0 000-2h2a1 1 0 100 2h-2zM19.153 14.447a1 1 0 00-1.414 1.414l1.414 1.414a1 1 0 001.414-1.414l-1.414-1.414z" />
                            </svg>
                            ‡∏≠‡∏ô‡∏∏‡∏°‡∏±‡∏ï‡∏¥‡∏Å‡∏≤‡∏£‡∏™‡∏≠‡∏ö‡∏à‡∏ö‡πÇ‡∏Ñ‡∏£‡∏á‡∏á‡∏≤‡∏ô
                        </a>
                    </li>

                    <li>
                        <a href="/admin/Report_project_dashbroad.html"
                            class="flex items-center p-3 text-white bg-indigo-600 rounded-md transition-colors">
                            <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 mr-3 text-white" viewBox="0 0 20 20"
                                fill="currentColor">
                                <path fill-rule="evenodd"
                                    d="M10 18a8 8 0 100-16 8 8 0 000 16zm-1-8a1 1 0 10-2 0v4a1 1 0 102 0v-4zm5-4a1 1 0 00-1-1H7a1 1 0 00-1 1v2a1 1 0 001 1h6a1 1 0 001-1V6z"
                                    clip-rule="evenodd" />
                            </svg>
                            ‡πÄ‡πÄ‡∏î‡∏ä‡∏ö‡∏≠‡∏£‡πå‡∏î‡∏™‡∏£‡∏∏‡∏õ‡∏†‡∏≤‡∏û‡∏£‡∏ß‡∏°
                        </a>
                    </li>
                </ul>
            </nav>
        </aside>

        <main class="flex-grow container mx-auto p-4 md:p-8">

    <!-- ‡∏ü‡∏¥‡∏•‡πÄ‡∏ï‡∏≠‡∏£‡πå‡∏™‡∏≤‡∏Ç‡∏≤ -->
    <div class="flex justify-end mb-6">
      <label class="mr-2 font-semibold text-gray-700">‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏™‡∏≤‡∏Ç‡∏≤:</label>
      <select id="majorSelect" class="border border-gray-300 rounded-lg p-2 shadow-sm focus:ring-2 focus:ring-blue-400">
        <option value="all">‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î</option>
        <option value="IT">IT</option>
        <option value="ITI">ITI</option>
        <option value="INE">INE</option>
        <option value="INET">INET</option>
      </select>
    </div>

    <!-- Cards ‡∏™‡∏£‡∏∏‡∏õ -->
    <section class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-5 gap-6 mb-10">
      <div class="bg-blue-100 p-6 rounded-2xl shadow text-center">
        <h3 class="text-lg font-semibold text-blue-700">‡πÇ‡∏Ñ‡∏£‡∏á‡∏á‡∏≤‡∏ô‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î</h3>
        <p id="totalCount" class="text-4xl font-bold text-blue-600 mt-2">0</p>
      </div>
      <div class="bg-green-100 p-6 rounded-2xl shadow text-center">
        <h3 class="text-lg font-semibold text-green-700">‡∏™‡∏≠‡∏ö‡∏ú‡πà‡∏≤‡∏ô</h3>
        <p id="passedCount" class="text-4xl font-bold text-green-600 mt-2">0</p>
      </div>
      <div class="bg-red-100 p-6 rounded-2xl shadow text-center">
        <h3 class="text-lg font-semibold text-red-700">‡∏™‡∏≠‡∏ö‡πÑ‡∏°‡πà‡∏ú‡πà‡∏≤‡∏ô</h3>
        <p id="failedCount" class="text-4xl font-bold text-red-600 mt-2">0</p>
      </div>
      <div class="bg-yellow-100 p-6 rounded-2xl shadow text-center">
        <h3 class="text-lg font-semibold text-yellow-700">‡∏≠‡∏¢‡∏π‡πà‡∏£‡∏∞‡∏´‡∏ß‡πà‡∏≤‡∏á‡∏î‡∏≥‡πÄ‡∏ô‡∏¥‡∏ô‡∏Å‡∏≤‡∏£</h3>
        <p id="progressCount" class="text-4xl font-bold text-yellow-600 mt-2">0</p>
      </div>
      <div class="bg-indigo-100 p-6 rounded-2xl shadow text-center">
        <h3 class="text-lg font-semibold text-indigo-700">‡∏≠‡∏±‡∏ï‡∏£‡∏≤‡∏Å‡∏≤‡∏£‡∏ú‡πà‡∏≤‡∏ô (%)</h3>
        <p id="avgRate" class="text-4xl font-bold text-indigo-600 mt-2">0%</p>
      </div>
    </section>

    <!-- ‡∏Å‡∏£‡∏≤‡∏ü‡∏£‡∏ß‡∏° -->
    <section class="grid grid-cols-1 lg:grid-cols-2 gap-8 mb-10">
      <div class="bg-white rounded-2xl shadow p-6">
        <h2 class="text-2xl font-semibold text-center mb-4 text-gray-700">
          ‡∏Å‡∏£‡∏≤‡∏ü‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏ó‡∏µ‡πà‡∏ú‡πà‡∏≤‡∏ô / ‡πÑ‡∏°‡πà‡∏ú‡πà‡∏≤‡∏ô‡∏ï‡∏≤‡∏°‡∏™‡∏≤‡∏Ç‡∏≤
        </h2>
        <canvas id="barChart" height="150"></canvas>
      </div>

      <div class="bg-white rounded-2xl shadow p-6">
        <h2 class="text-2xl font-semibold text-center mb-4 text-gray-700">
          ‡∏™‡∏±‡∏î‡∏™‡πà‡∏ß‡∏ô‡∏ú‡∏•‡∏Å‡∏≤‡∏£‡∏™‡∏≠‡∏ö‡πÇ‡∏Ñ‡∏£‡∏á‡∏á‡∏≤‡∏ô (Pie Chart)
        </h2>
        <canvas id="pieChart" height="150"></canvas>
      </div>
    </section>

    <!-- ‡∏≠‡∏±‡∏ô‡∏î‡∏±‡∏ö‡∏™‡∏π‡∏á‡∏™‡∏∏‡∏î‡πÅ‡∏•‡∏∞‡∏ï‡πà‡∏≥‡∏™‡∏∏‡∏î -->
    <section class="grid grid-cols-1 lg:grid-cols-2 gap-8 mb-10">
      <!-- ‡∏ú‡πà‡∏≤‡∏ô‡∏°‡∏≤‡∏Å‡∏™‡∏∏‡∏î -->
      <div class="bg-white rounded-2xl shadow p-6">
        <h2 class="text-2xl font-semibold text-center mb-6 text-gray-700">
          ‡∏≠‡∏±‡∏ô‡∏î‡∏±‡∏ö‡∏™‡∏≤‡∏Ç‡∏≤‡∏ó‡∏µ‡πà‡∏°‡∏µ‡∏≠‡∏±‡∏ï‡∏£‡∏≤‡∏Å‡∏≤‡∏£‡∏ú‡πà‡∏≤‡∏ô‡∏™‡∏π‡∏á‡∏™‡∏∏‡∏î 5 ‡∏•‡∏≥‡∏î‡∏±‡∏ö‡πÅ‡∏£‡∏Å
        </h2>
        <canvas id="topMajorChart" height="120"></canvas>
      </div>

      <!-- ‡πÑ‡∏°‡πà‡∏ú‡πà‡∏≤‡∏ô‡∏°‡∏≤‡∏Å‡∏™‡∏∏‡∏î -->
      <div class="bg-white rounded-2xl shadow p-6">
        <h2 class="text-2xl font-semibold text-center mb-6 text-gray-700">
        ‡∏≠‡∏±‡∏ô‡∏î‡∏±‡∏ö‡∏™‡∏≤‡∏Ç‡∏≤‡∏ó‡∏µ‡πà‡∏°‡∏µ‡∏≠‡∏±‡∏ï‡∏£‡∏≤‡∏Å‡∏≤‡∏£‡πÑ‡∏°‡πà‡∏ú‡πà‡∏≤‡∏ô‡∏™‡∏π‡∏á‡∏™‡∏∏‡∏î 5 ‡∏•‡∏≥‡∏î‡∏±‡∏ö‡πÅ‡∏£‡∏Å
        </h2>
        <canvas id="failMajorChart" height="120"></canvas>
      </div>
    </section>

    <!-- üîç ‡∏™‡∏ñ‡∏¥‡∏ï‡∏¥‡∏ó‡∏µ‡πà‡∏ô‡πà‡∏≤‡∏™‡∏ô‡πÉ‡∏à -->
    <section class="bg-blue-50 p-6 rounded-2xl shadow-lg mb-10">
      <h2 class="text-2xl font-bold text-blue-700 mb-4">üîç ‡∏™‡∏ñ‡∏¥‡∏ï‡∏¥‡∏ó‡∏µ‡πà‡∏ô‡πà‡∏≤‡∏Ñ‡∏¥‡∏î‡πÅ‡∏•‡∏∞‡πÅ‡∏ô‡∏ß‡∏ó‡∏≤‡∏á‡∏ß‡∏¥‡πÄ‡∏Ñ‡∏£‡∏≤‡∏∞‡∏´‡πå‡∏ï‡πà‡∏≠</h2>
      <ul class="list-disc list-inside text-gray-700 leading-relaxed space-y-2">
        <li>‡∏≠‡∏±‡∏ï‡∏£‡∏≤‡∏Å‡∏≤‡∏£‡∏ú‡πà‡∏≤‡∏ô‡πÄ‡∏â‡∏•‡∏µ‡πà‡∏¢‡∏Ç‡∏≠‡∏á‡∏ó‡∏∏‡∏Å‡∏™‡∏≤‡∏Ç‡∏≤‡∏≠‡∏¢‡∏π‡πà‡∏ó‡∏µ‡πà <strong id="avgPassRateAll"></strong>%</li>
        <li>‡∏™‡∏≤‡∏Ç‡∏≤‡∏ó‡∏µ‡πà‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô‡πÄ‡∏â‡∏•‡∏µ‡πà‡∏¢‡∏™‡∏π‡∏á‡∏™‡∏∏‡∏î‡∏Ñ‡∏∑‡∏≠ <strong id="topScoreMajor"></strong> ‡πÇ‡∏î‡∏¢‡∏°‡∏µ‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô‡πÄ‡∏â‡∏•‡∏µ‡πà‡∏¢ <strong id="topScoreValue"></strong> ‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô</li>
        <li>‡∏™‡∏≤‡∏Ç‡∏≤‡∏ó‡∏µ‡πà‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô‡πÄ‡∏â‡∏•‡∏µ‡πà‡∏¢‡∏ï‡πà‡∏≥‡∏™‡∏∏‡∏î‡∏Ñ‡∏∑‡∏≠ <strong id="lowScoreMajor"></strong> ‡πÇ‡∏î‡∏¢‡∏°‡∏µ‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô‡πÄ‡∏â‡∏•‡∏µ‡πà‡∏¢ <strong id="lowScoreValue"></strong> ‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô</li>
        <li>‡∏à‡∏≤‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏û‡∏ö‡∏ß‡πà‡∏≤ ‚Äú<strong>‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô‡πÄ‡∏â‡∏•‡∏µ‡πà‡∏¢</strong>‚Äù ‡∏°‡∏µ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏±‡∏°‡∏û‡∏±‡∏ô‡∏ò‡πå‡πÄ‡∏ä‡∏¥‡∏á‡∏ö‡∏ß‡∏Å‡∏Å‡∏±‡∏ö ‚Äú<strong>‡∏≠‡∏±‡∏ï‡∏£‡∏≤‡∏Å‡∏≤‡∏£‡∏ú‡πà‡∏≤‡∏ô</strong>‚Äù ‡∏£‡∏≤‡∏ß <strong>+0.83</strong> (‡πÅ‡∏õ‡∏•‡∏ß‡πà‡∏≤‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô‡∏™‡∏π‡∏á‡∏°‡∏µ‡πÅ‡∏ô‡∏ß‡πÇ‡∏ô‡πâ‡∏°‡∏ú‡πà‡∏≤‡∏ô‡∏°‡∏≤‡∏Å)</li>
        <li>‡∏Ç‡πâ‡∏≠‡πÄ‡∏™‡∏ô‡∏≠‡πÅ‡∏ô‡∏∞: ‡∏™‡∏≤‡∏Ç‡∏≤‡∏ó‡∏µ‡πà‡∏°‡∏µ‡∏≠‡∏±‡∏ï‡∏£‡∏≤‡∏Å‡∏≤‡∏£‡πÑ‡∏°‡πà‡∏ú‡πà‡∏≤‡∏ô‡πÄ‡∏Å‡∏¥‡∏ô 40% ‡∏Ñ‡∏ß‡∏£‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏Å‡∏≤‡∏£‡∏≠‡∏≠‡∏Å‡πÅ‡∏ö‡∏ö‡πÇ‡∏Ñ‡∏£‡∏á‡∏á‡∏≤‡∏ô‡∏´‡∏£‡∏∑‡∏≠‡πÄ‡∏Å‡∏ì‡∏ë‡πå‡∏Å‡∏≤‡∏£‡∏õ‡∏£‡∏∞‡πÄ‡∏°‡∏¥‡∏ô‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÄ‡∏ï‡∏¥‡∏°</li>
      </ul>
    </section>

    <!-- ‡∏õ‡∏∏‡πà‡∏° Export -->
    <div class="text-center mt-8">
      <button id="exportBtn" class="bg-blue-600 text-white px-6 py-3 rounded-xl shadow hover:bg-blue-700 transition">
        ‡∏î‡∏≤‡∏ß‡∏ô‡πå‡πÇ‡∏´‡∏•‡∏î‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô (Excel)
      </button>
    </div>
  </main>

  <script>
    const projectData = [
      { name: "‡∏£‡∏∞‡∏ö‡∏ö‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏£‡πâ‡∏≤‡∏ô‡∏Å‡∏≤‡πÅ‡∏ü‡∏≠‡∏±‡∏à‡∏â‡∏£‡∏¥‡∏¢‡∏∞", status: "‡∏ú‡πà‡∏≤‡∏ô", major: "IT", score: 85 },
      { name: "IoT Smart Farm", status: "‡∏ú‡πà‡∏≤‡∏ô", major: "ITI", score: 80 },
      { name: "‡∏£‡∏∞‡∏ö‡∏ö‡∏ö‡∏£‡∏¥‡∏´‡∏≤‡∏£‡πÇ‡∏£‡∏á‡πÄ‡∏£‡∏µ‡∏¢‡∏ô", status: "‡πÑ‡∏°‡πà‡∏ú‡πà‡∏≤‡∏ô", major: "INE", score: 49 },
      { name: "‡∏£‡∏∞‡∏ö‡∏ö‡∏Ñ‡∏ß‡∏ö‡∏Ñ‡∏∏‡∏°‡∏û‡∏•‡∏±‡∏á‡∏á‡∏≤‡∏ô", status: "‡∏ú‡πà‡∏≤‡∏ô", major: "INET", score: 90 },
      { name: "‡πÄ‡∏ß‡πá‡∏ö‡∏à‡∏≠‡∏á‡∏´‡πâ‡∏≠‡∏á‡πÄ‡∏£‡∏µ‡∏¢‡∏ô", status: "‡∏≠‡∏¢‡∏π‡πà‡∏£‡∏∞‡∏´‡∏ß‡πà‡∏≤‡∏á‡∏î‡∏≥‡πÄ‡∏ô‡∏¥‡∏ô‡∏Å‡∏≤‡∏£", major: "IT", score: 60 },
      { name: "AI ‡∏ï‡∏£‡∏ß‡∏à‡∏à‡∏±‡∏ö‡∏ß‡∏±‡∏ï‡∏ñ‡∏∏", status: "‡∏ú‡πà‡∏≤‡∏ô", major: "ITI", score: 88 },
      { name: "‡πÄ‡∏Ñ‡∏£‡∏∑‡∏≠‡∏Ç‡πà‡∏≤‡∏¢‡∏ï‡∏£‡∏ß‡∏à‡∏ß‡∏±‡∏î‡∏Ñ‡∏∏‡∏ì‡∏†‡∏≤‡∏û‡∏≠‡∏≤‡∏Å‡∏≤‡∏®", status: "‡πÑ‡∏°‡πà‡∏ú‡πà‡∏≤‡∏ô", major: "INET", score: 50 },
      { name: "‡πÅ‡∏≠‡∏õ‡∏û‡∏¢‡∏≤‡∏Å‡∏£‡∏ì‡πå‡∏ù‡∏ô", status: "‡∏ú‡πà‡∏≤‡∏ô", major: "INE", score: 82 },
      { name: "‡∏£‡∏∞‡∏ö‡∏ö‡∏ß‡∏¥‡πÄ‡∏Ñ‡∏£‡∏≤‡∏∞‡∏´‡πå‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏û‡∏•‡∏±‡∏á‡∏á‡∏≤‡∏ô", status: "‡∏ú‡πà‡∏≤‡∏ô", major: "IT", score: 95 },
      { name: "‡∏£‡∏∞‡∏ö‡∏ö‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏™‡∏ï‡πä‡∏≠‡∏Å", status: "‡πÑ‡∏°‡πà‡∏ú‡πà‡∏≤‡∏ô", major: "ITI", score: 45 },
      { name: "‡∏£‡∏∞‡∏ö‡∏ö‡πÅ‡∏à‡πâ‡∏á‡∏ã‡πà‡∏≠‡∏°‡∏≠‡∏≠‡∏ô‡πÑ‡∏•‡∏ô‡πå", status: "‡∏ú‡πà‡∏≤‡∏ô", major: "INET", score: 78 },
      { name: "‡πÅ‡∏≠‡∏õ‡∏ï‡∏¥‡∏î‡∏ï‡∏≤‡∏°‡∏Å‡∏≤‡∏£‡πÄ‡∏£‡∏µ‡∏¢‡∏ô", status: "‡∏ú‡πà‡∏≤‡∏ô", major: "IT", score: 86 },
      { name: "‡∏£‡∏∞‡∏ö‡∏ö‡∏Ñ‡∏ß‡∏≤‡∏°‡∏õ‡∏•‡∏≠‡∏î‡∏†‡∏±‡∏¢‡πÉ‡∏ô‡πÇ‡∏£‡∏á‡∏á‡∏≤‡∏ô", status: "‡∏≠‡∏¢‡∏π‡πà‡∏£‡∏∞‡∏´‡∏ß‡πà‡∏≤‡∏á‡∏î‡∏≥‡πÄ‡∏ô‡∏¥‡∏ô‡∏Å‡∏≤‡∏£", major: "INE", score: 62 },
      { name: "‡∏£‡∏∞‡∏ö‡∏ö IoT Smart Room", status: "‡∏ú‡πà‡∏≤‡∏ô", major: "INET", score: 91 },
      { name: "‡πÅ‡∏≠‡∏õ‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥‡∏Å‡∏≤‡∏£‡∏≠‡∏≠‡∏Å‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏Å‡∏≤‡∏¢", status: "‡πÑ‡∏°‡πà‡∏ú‡πà‡∏≤‡∏ô", major: "INE", score: 48 },
      { name: "‡∏£‡∏∞‡∏ö‡∏ö‡∏õ‡∏£‡∏∞‡∏°‡∏ß‡∏•‡∏ú‡∏•‡∏†‡∏≤‡∏û", status: "‡∏ú‡πà‡∏≤‡∏ô", major: "ITI", score: 89 },
      { name: "‡∏£‡∏∞‡∏ö‡∏ö Smart Parking", status: "‡∏ú‡πà‡∏≤‡∏ô", major: "IT", score: 92 },
      { name: "‡∏£‡∏∞‡∏ö‡∏ö‡∏Ñ‡∏ß‡∏ö‡∏Ñ‡∏∏‡∏°‡∏≠‡∏±‡∏ï‡πÇ‡∏ô‡∏°‡∏±‡∏ï‡∏¥", status: "‡∏≠‡∏¢‡∏π‡πà‡∏£‡∏∞‡∏´‡∏ß‡πà‡∏≤‡∏á‡∏î‡∏≥‡πÄ‡∏ô‡∏¥‡∏ô‡∏Å‡∏≤‡∏£", major: "ITI", score: 70 },
    ];

    const majors = ["IT", "ITI", "INE", "INET"];

    function calculateStats(filterMajor = "all") {
      const filtered = filterMajor === "all" ? projectData : projectData.filter(p => p.major === filterMajor);
      const total = filtered.length;
      const passed = filtered.filter(p => p.status === "‡∏ú‡πà‡∏≤‡∏ô").length;
      const failed = filtered.filter(p => p.status === "‡πÑ‡∏°‡πà‡∏ú‡πà‡∏≤‡∏ô").length;
      const progress = filtered.filter(p => p.status === "‡∏≠‡∏¢‡∏π‡πà‡∏£‡∏∞‡∏´‡∏ß‡πà‡∏≤‡∏á‡∏î‡∏≥‡πÄ‡∏ô‡∏¥‡∏ô‡∏Å‡∏≤‡∏£").length;
      const passRate = total > 0 ? ((passed / total) * 100).toFixed(1) : 0;
      document.getElementById("totalCount").textContent = total;
      document.getElementById("passedCount").textContent = passed;
      document.getElementById("failedCount").textContent = failed;
      document.getElementById("progressCount").textContent = progress;
      document.getElementById("avgRate").textContent = `${passRate}%`;
      updatePieChart(passed, failed, progress);
    }

    function createBarChart() {
      const ctx = document.getElementById("barChart").getContext("2d");
      const passData = majors.map(m => projectData.filter(p => p.major === m && p.status === "‡∏ú‡πà‡∏≤‡∏ô").length);
      const failData = majors.map(m => projectData.filter(p => p.major === m && p.status === "‡πÑ‡∏°‡πà‡∏ú‡πà‡∏≤‡∏ô").length);
      new Chart(ctx, {
        type: "bar",
        data: {
          labels: majors,
          datasets: [
            { label: "‡∏ú‡πà‡∏≤‡∏ô", data: passData, backgroundColor: "#60A5FA" },
            { label: "‡πÑ‡∏°‡πà‡∏ú‡πà‡∏≤‡∏ô", data: failData, backgroundColor: "#1E3A8A" }
          ]
        },
        options: { responsive: true, plugins: { legend: { position: "bottom" } } }
      });
    }

    let pieChart;
    function updatePieChart(passed, failed, progress) {
      const ctx = document.getElementById("pieChart").getContext("2d");
      if (pieChart) pieChart.destroy();
      pieChart = new Chart(ctx, {
        type: "pie",
        data: {
          labels: ["‡∏ú‡πà‡∏≤‡∏ô", "‡πÑ‡∏°‡πà‡∏ú‡πà‡∏≤‡∏ô", "‡∏≠‡∏¢‡∏π‡πà‡∏£‡∏∞‡∏´‡∏ß‡πà‡∏≤‡∏á‡∏î‡∏≥‡πÄ‡∏ô‡∏¥‡∏ô‡∏Å‡∏≤‡∏£"],
          datasets: [{ data: [passed, failed, progress], backgroundColor: ["#3B82F6", "#1E3A8A", "#93C5FD"] }]
        },
        options: { plugins: { legend: { position: "bottom" } } }
      });
    }

    function createTopMajorChart() {
      const stats = majors.map(m => {
        const total = projectData.filter(p => p.major === m).length;
        const passed = projectData.filter(p => p.major === m && p.status === "‡∏ú‡πà‡∏≤‡∏ô").length;
        return { major: m, rate: total > 0 ? (passed / total) * 100 : 0 };
      }).sort((a, b) => b.rate - a.rate).slice(0, 5);
      new Chart(document.getElementById("topMajorChart"), {
        type: "bar",
        data: {
          labels: stats.map(s => s.major),
          datasets: [{ data: stats.map(s => s.rate), backgroundColor: "#2563EB" }]
        },
        options: { plugins: { legend: { display: false } }, scales: { y: { beginAtZero: true } } }
      });
    }

    function createFailMajorChart() {
      const stats = majors.map(m => {
        const total = projectData.filter(p => p.major === m).length;
        const failed = projectData.filter(p => p.major === m && p.status === "‡πÑ‡∏°‡πà‡∏ú‡πà‡∏≤‡∏ô").length;
        return { major: m, rate: total > 0 ? (failed / total) * 100 : 0 };
      }).sort((a, b) => b.rate - a.rate).slice(0, 5);
      new Chart(document.getElementById("failMajorChart"), {
        type: "bar",
        data: {
          labels: stats.map(s => s.major),
          datasets: [{ data: stats.map(s => s.rate), backgroundColor: "#93C5FD" }]
        },
        options: { plugins: { legend: { display: false } }, scales: { y: { beginAtZero: true } } }
      });
    }

    function calculateAdvancedStats() {
      const majorScores = majors.map(m => {
        const scores = projectData.filter(p => p.major === m).map(p => p.score);
        const avg = scores.reduce((a, b) => a + b, 0) / scores.length;
        return { major: m, avg };
      });
      const top = majorScores.reduce((a, b) => (a.avg > b.avg ? a : b));
      const low = majorScores.reduce((a, b) => (a.avg < b.avg ? a : b));
      const avgRateAll = (
        projectData.filter(p => p.status === "‡∏ú‡πà‡∏≤‡∏ô").length /
        projectData.length *
        100
      ).toFixed(1);
      document.getElementById("avgPassRateAll").textContent = avgRateAll;
      document.getElementById("topScoreMajor").textContent = top.major;
      document.getElementById("topScoreValue").textContent = top.avg.toFixed(1);
      document.getElementById("lowScoreMajor").textContent = low.major;
      document.getElementById("lowScoreValue").textContent = low.avg.toFixed(1);
    }

    calculateStats();
    createBarChart();
    createTopMajorChart();
    createFailMajorChart();
    calculateAdvancedStats();

    document.getElementById("majorSelect").addEventListener("change", e => calculateStats(e.target.value));

    document.getElementById("exportBtn").addEventListener("click", () => {
      const ws = XLSX.utils.json_to_sheet(projectData);
      const wb = XLSX.utils.book_new();
      XLSX.utils.book_append_sheet(wb, ws, "‡πÇ‡∏Ñ‡∏£‡∏á‡∏á‡∏≤‡∏ô");
      XLSX.writeFile(wb, "‡∏™‡∏£‡∏∏‡∏õ‡∏ú‡∏•‡∏™‡∏≠‡∏ö‡πÇ‡∏Ñ‡∏£‡∏á‡∏á‡∏≤‡∏ô_‡πÄ‡∏ä‡∏¥‡∏á‡∏™‡∏ñ‡∏¥‡∏ï‡∏¥.xlsx");
    });
document.addEventListener('DOMContentLoaded', () => {
    const sidebar = document.getElementById('sidebar');
    const sidebarOpenBtn = document.getElementById('sidebar-open-btn');
    const sidebarCloseBtn = document.getElementById('sidebar-close-btn');
    const lgBreakpoint = 1024; // Tailwind's 'lg' breakpoint

    // Function to open the sidebar
    const openSidebar = () => {
        sidebar.classList.remove('-left-full');
        sidebar.classList.add('left-0');
    };

    // Function to close the sidebar
    const closeSidebar = () => {
        sidebar.classList.remove('left-0');
        sidebar.classList.add('-left-full');
    };

    // Event listeners for opening and closing the sidebar
    if (sidebarOpenBtn) {
        sidebarOpenBtn.addEventListener('click', openSidebar);
    }

    if (sidebarCloseBtn) {
        sidebarCloseBtn.addEventListener('click', closeSidebar);
    }
    
    // Close sidebar when clicking outside on small screens
    document.addEventListener('click', (event) => {
        if (window.innerWidth < lgBreakpoint) {
            // Check if the click is outside the sidebar and not on the open button
            if (!sidebar.contains(event.target) && !sidebarOpenBtn.contains(event.target)) {
                closeSidebar();
            }
        }
    });

    // Handle responsive behavior based on screen size
    const handleResize = () => {
        if (window.innerWidth >= lgBreakpoint) {
            // Desktop: Sidebar is relative and always visible
            sidebar.classList.remove('fixed', '-left-full');
            sidebar.classList.add('relative', 'left-0');
        } else {
            // Mobile: Sidebar is fixed and hidden by default
            sidebar.classList.remove('relative', 'left-0');
            sidebar.classList.add('fixed', '-left-full');
        }
    };

    // Initial check and event listener for window resize
    handleResize();
    window.addEventListener('resize', handleResize);
});
  </script>
</body>
</html>
